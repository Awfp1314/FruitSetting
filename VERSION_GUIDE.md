# 版本更新系统使用指南

## 版本号规则

版本号格式：`v主版本.次版本.修订版本`（例如：v2.1.0）

- **主版本（Major）**：重大更新，可能包含不兼容的改动
- **次版本（Minor）**：功能更新，添加新功能但保持向后兼容
- **修订版本（Patch）**：问题修复，修复 bug 或小改进

## 如何更新版本

### 1. 修改版本号

在两个地方同步修改版本号：

**package.json**

```json
{
  "version": "2.1.0"
}
```

**src/constants/changelog.js**

```javascript
export const CURRENT_VERSION = '2.1.0';
```

### 2. 添加更新日志

在 `src/constants/changelog.js` 的 `CHANGELOG` 对象中添加新版本信息：

```javascript
export const CHANGELOG = {
  '2.1.0': {
    date: '2026-02-09', // 更新日期
    type: 'minor', // 更新类型：major | minor | patch
    title: '记账系统重构', // 更新标题
    changes: [
      // 更新内容列表
      '✨ 进货和销售完全分离',
      '📦 新增库存管理功能',
      '💰 利润计算更准确',
    ],
  },
  // ... 其他版本
};
```

### 3. 提交代码

```bash
git add -A
git commit -m "chore: 发布 v2.1.0 - 记账系统重构"
git push
```

## 更新类型说明

### Major（主版本）- 重大更新

- 全新的功能模块
- 重大的界面改版
- 不兼容的 API 变更
- 示例：v1.0.0 → v2.0.0

### Minor（次版本）- 功能更新

- 新增功能
- 功能优化
- 保持向后兼容
- 示例：v2.0.0 → v2.1.0

### Patch（修订版本）- 问题修复

- Bug 修复
- 性能优化
- 小的改进
- 示例：v2.1.0 → v2.1.1

## 用户体验

用户首次打开更新后的应用时，会看到：

1. **更新弹窗**：显示版本号、更新类型、更新日期
2. **更新内容**：列出所有更新项
3. **开始使用按钮**：关闭弹窗后不再显示（直到下次更新）

## 示例：发布一个修复版本

假设当前版本是 v2.1.0，现在要发布 v2.1.1 修复一些问题：

1. 修改 `package.json` 和 `changelog.js` 中的版本号为 `2.1.1`

2. 在 `changelog.js` 添加：

```javascript
'2.1.1': {
  date: '2026-02-10',
  type: 'patch',
  title: '问题修复',
  changes: [
    '🐛 修复库存扣减错误',
    '🐛 修复日期显示问题',
    '⚡ 优化页面加载速度',
  ],
},
```

3. 提交：

```bash
git commit -m "fix: 修复库存扣减和日期显示问题 (v2.1.1)"
```

## 常用 Emoji 标记

- ✨ 新功能
- 🐛 Bug 修复
- 📦 功能模块
- 💰 业务相关
- 🎨 界面优化
- ⚡ 性能优化
- 🔄 重构
- 📱 移动端优化
- 🤖 AI 功能
- 📊 数据统计
